<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="plotter.js"></script>
    <script type="text/javascript">
      function daniel() {
        var kMillisecondsPerDay = 1000 * 60 * 60 * 24;
        var kOuncesToGrams = 28.3495;
        var kDisposableDiaperMassGrams = 20;
        var kReusableDiaperMassGrams = 80;
        var kDressMassGrams = 92;
        var kOnesieMassGrams = 78;
        var data = [
          {
            timestamp: '2014/08/27 21:00',
            scale: 'Hospital',
            totalMassGrams: 4105
          }, {
            timestamp: '2014/08/29 11:00',
            scale: 'Hospital',
            totalMassGrams: 3815
          }, {
            timestamp: '2014/08/29 18:00',
            scale: 'Hospital',
            totalMassGrams: 3790
          }, {
            timestamp: '2014/08/31 13:00',
            scale: 'Nurse',
            totalMassGrams: 3886 // Dubious!
          }, {
            timestamp: '2014/09/01 02:00',
            scale: 'ER',
            totalMassGrams: 3820
          }, {
            timestamp: '2014/09/02 16:00',
            scale: 'Doctor',
            totalMassGrams: 3880,
            nonBabyMassGrams: kDisposableDiaperMassGrams
          }, {
            timestamp: '2014/09/04 11:48',
            totalMassGrams: 3910,
            nonBabyMassGrams: kDisposableDiaperMassGrams
          }, {
            timestamp: '2014/09/05 15:30',
            totalMassGrams: 141.5 * kOuncesToGrams, // 8lbs 13.5oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/06 14:30',
            totalMassGrams: 142.1 * kOuncesToGrams, // 8lbs 14.1oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/08 11:40',
            scale: 'Doctor',
            totalMassGrams: 3970,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/08 11:50',
            totalMassGrams: 4080,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/08 12:00',
            totalMassGrams: 3990,
            nonBabyMassGrams: kDisposableDiaperMassGrams
          }, {
            timestamp: '2014/09/08 13:40',
            totalMassGrams: 143.9 * kOuncesToGrams, // 8lbs 15.9oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/08 13:50',
            totalMassGrams: 142.9 * kOuncesToGrams, // 8lbs 14.9oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/09 14:30',
            totalMassGrams: 142.9 * kOuncesToGrams, // 8lbs 14.9oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/10 16:00',
            totalMassGrams: 145 * kOuncesToGrams, // 9lbs 1oz,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/11 16:00',
            totalMassGrams: 4114,
            nonBabyMassGrams: kReusableDiaperMassGrams
          }, {
            timestamp: '2014/09/12 13:30',
            scale: 'Doctor',
            totalMassGrams: 4050
          }, {
            timestamp: '2014/09/12 16:15',
            totalMassGrams: 4160,
            nonBabyMassGrams: kDisposableDiaperMassGrams + kDressMassGrams
          }, {
            timestamp: '2014/09/13 16:10',
            totalMassGrams: 4226,
            nonBabyMassGrams: kReusableDiaperMassGrams + kDressMassGrams
          }, {
            timestamp: '2014/09/15 12:20',
            totalMassGrams: 4308,
            nonBabyMassGrams: kReusableDiaperMassGrams + kDressMassGrams
          }, {
            timestamp: '2014/09/15 12:30',
            totalMassGrams: 4290,
            nonBabyMassGrams: kReusableDiaperMassGrams + kDressMassGrams
          }, {
            timestamp: '2014/09/16 15:00',
            totalMassGrams: 4354,
            nonBabyMassGrams: kReusableDiaperMassGrams + kDressMassGrams
          }, {
            timestamp: '2014/09/17 15:00',
            totalMassGrams: 4324,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/18 14:00',
            totalMassGrams: 4348,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/19 16:00',
            totalMassGrams: 4396,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/22 12:45',
            totalMassGrams: 4348,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/22 15:15',
            totalMassGrams: 4416,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/24 13:00',
            totalMassGrams: 4445,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/25 11:15',
            totalMassGrams: 4461,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/25 14:30',
            scale: 'Doctor',
            totalMassGrams: 4270,
            nonBabyMassGrams: kDisposableDiaperMassGrams
          }, {
            timestamp: '2014/09/26 15:15',
            totalMassGrams: 157.6 * kOuncesToGrams, // 9lbs 13.6oz
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/27 12:40',
            totalMassGrams: 4486,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/29 16:15',
            totalMassGrams: 4522,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/09/30 16:00',
            totalMassGrams: 4538,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/01 16:30',
            totalMassGrams: 4580,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/02 17:00',
            totalMassGrams: 4578,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/03 14:30',
            totalMassGrams: 4634,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/04 14:30',
            totalMassGrams: 4632,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/07 18:30',
            totalMassGrams: 4714,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }, {
            timestamp: '2014/10/09 17:00',
            totalMassGrams: 4760,
            nonBabyMassGrams: kReusableDiaperMassGrams + kOnesieMassGrams
          }
        ];
        var startTimestamp = new Date(data[0].timestamp);
        var startMass = data[0].totalMassGrams;

        var scaleColors = {};
        var kThreeBridges = 'Three Bridges';
        var colors = ['blue', 'cyan', 'green', 'black'];
        data.forEach(function(entry) {
          if (entry.scale && entry.scale !== kThreeBridges && !scaleColors[entry.scale]) {
            scaleColors[entry.scale] = colors[Object.keys(scaleColors).length % colors.length];
          }
        });
        scaleColors[kThreeBridges] = 'red';

        var plot = new Plot(1000, 500);
        document.body.appendChild(plot.canvas());

        plot.plot(
            data.map(function(entry) { return (new Date(entry.timestamp) - startTimestamp) / kMillisecondsPerDay }),
            data.map(function(entry) { return entry.totalMassGrams - (entry.nonBabyMassGrams ? entry.nonBabyMassGrams : 0) }),
            {
              lineColor: 'red',
              markers: data.map(function(entry) { return (!entry.scale || entry.scale === kThreeBridges) ? '.' : 'o'; }),
              markerColors: data.map(function(entry) { return scaleColors[entry.scale ? entry.scale : kThreeBridges]; })
            });
        plot.setGridOn(true);

        var endDay = plot.getAxisRanges()[0].max();
        var startMassesGrams = [3700, 3750, 3800];
        plot.setHoldOn(true);
        startMassesGrams.forEach(function(startMass) {
          plot.plot([0, endDay], [startMass, startMass + endDay * 20], {lineColor: 'blue', lineStyle: '--'});
        });

        var startMass = data[0].totalMassGrams - (data[0].nonBabyMassGrams ? data[0].nonBabyMassGrams : 0);
        plot.plot([0, endDay], [startMass, startMass], {lineColor: 'black', lineStyle: '--'});
      }
    </script>
  </head>
  <body onload="daniel();">
  <body>
</html>
